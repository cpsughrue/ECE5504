import numpy as np
import math
import matplotlib.pyplot as plt

sin_table = np.array([
    -536870912,
    -536868380,
    -536860785,
    -536848128,
    -536830407,
    -536807624,
    -536779778,
    -536746870,
    -536708900,
    -536665868,
    -536617775,
    -536564622,
    -536506408,
    -536443135,
    -536374802,
    -536301411,
    -536222962,
    -536139457,
    -536050895,
    -535957277,
    -535858605,
    -535754880,
    -535646102,
    -535532273,
    -535413392,
    -535289463,
    -535160485,
    -535026461,
    -534887390,
    -534743276,
    -534594118,
    -534439918,
    -534280679,
    -534116400,
    -533947085,
    -533772734,
    -533593349,
    -533408932,
    -533219484,
    -533025008,
    -532825505,
    -532620977,
    -532411426,
    -532196854,
    -531977262,
    -531752654,
    -531523031,
    -531288395,
    -531048749,
    -530804095,
    -530554435,
    -530299771,
    -530040106,
    -529775442,
    -529505782,
    -529231129,
    -528951484,
    -528666851,
    -528377232,
    -528082630,
    -527783048,
    -527478489,
    -527168955,
    -526854449,
    -526534975,
    -526210535,
    -525881132,
    -525546770,
    -525207452,
    -524863181,
    -524513959,
    -524159792,
    -523800680,
    -523436629,
    -523067642,
    -522693722,
    -522314872,
    -521931096,
    -521542399,
    -521148782,
    -520750251,
    -520346809,
    -519938459,
    -519525206,
    -519107053,
    -518684005,
    -518256066,
    -517823238,
    -517385527,
    -516942937,
    -516495472,
    -516043136,
    -515585933,
    -515123867,
    -514656944,
    -514185167,
    -513708541,
    -513227070,
    -512740759,
    -512249612,
    -511753635,
    -511252831,
    -510747206,
    -510236764,
    -509721510,
    -509201449,
    -508676586,
    -508146925,
    -507612473,
    -507073233,
    -506529211,
    -505980412,
    -505426841,
    -504868504,
    -504305406,
    -503737551,
    -503164946,
    -502587595,
    -502005505,
    -501418681,
    -500827127,
    -500230851,
    -499629857,
    -499024151,
    -498413738,
    -497798626,
    -497178818,
    -496554322,
    -495925143,
    -495291288,
    -494652761,
    -494009569,
    -493361718,
    -492709214,
    -492052064,
    -491390273,
    -490723849,
    -490052796,
    -489377121,
    -488696832,
    -488011934,
    -487322433,
    -486628336,
    -485929650,
    -485226382,
    -484518537,
    -483806123,
    -483089147,
    -482367614,
    -481641532,
    -480910908,
    -480175749,
    -479436061,
    -478691852,
    -477943128,
    -477189897,
    -476432166,
    -475669942,
    -474903231,
    -474132042,
    -473356382,
    -472576257,
    -471791675,
    -471002645,
    -470209172,
    -469411265,
    -468608931,
    -467802177,
    -466991012,
    -466175443,
    -465355477,
    -464531123,
    -463702387,
    -462869279,
    -462031805,
    -461189974,
    -460343794,
    -459493272,
    -458638417,
    -457779237,
    -456915739,
    -456047933,
    -455175825,
    -454299425,
    -453418740,
    -452533779,
    -451644551,
    -450751063,
    -449853324,
    -448951343,
    -448045128,
    -447134687,
    -446220029,
    -445301164,
    -444378098,
    -443450842,
    -442519404,
    -441583793,
    -440644017,
    -439700085,
    -438752007,
    -437799791,
    -436843446,
    -435882981,
    -434918406,
    -433949729,
    -432976959,
    -432000106,
    -431019179,
    -430034188,
    -429045140,
    -428052047,
    -427054916,
    -426053758,
    -425048582,
    -424039398,
    -423026214,
    -422009041,
    -420987888,
    -419962765,
    -418933682,
    -417900647,
    -416863671,
    -415822764,
    -414777936,
    -413729195,
    -412676553,
    -411620019,
    -410559604,
    -409495316,
    -408427166,
    -407355165,
    -406279322,
    -405199647,
    -404116151,
    -403028844,
    -401937736,
    -400842837,
    -399744159,
    -398641710,
    -397535502,
    -396425544,
    -395311848,
    -394194424,
    -393073283,
    -391948434,
    -390819889,
    -389687658,
    -388551753,
    -387412182,
    -386268959,
    -385122092,
    -383971594,
    -382817474,
    -381659744,
    -380498414,
    -379333497,
    -378165002,
    -376992940,
    -375817323,
    -374638162,
    -373455468,
    -372269251,
    -371079524,
    -369886298,
    -368689583,
    -367489391,
    -366285733,
    -365078621,
    -363868066,
    -362654079,
    -361436673,
    -360215857,
    -358991645,
    -357764047,
    -356533075,
    -355298740,
    -354061055,
    -352820031,
    -351575679,
    -350328012,
    -349077041,
    -347822777,
    -346565234,
    -345304422,
    -344040354,
    -342773041,
    -341502495,
    -340228729,
    -338951754,
    -337671583,
    -336388227,
    -335101699,
    -333812010,
    -332519173,
    -331223201,
    -329924104,
    -328621897,
    -327316590,
    -326008196,
    -324696728,
    -323382197,
    -322064617,
    -320743999,
    -319420357,
    -318093702,
    -316764048,
    -315431406,
    -314095789,
    -312757210,
    -311415682,
    -310071216,
    -308723827,
    -307373526,
    -306020326,
    -304664240,
    -303305281,
    -301943461,
    -300578794,
    -299211292,
    -297840969,
    -296467836,
    -295091908,
    -293713197,
    -292331715,
    -290947477,
    -289560495,
    -288170782,
    -286778352,
    -285383217,
    -283985390,
    -282584885,
    -281181716,
    -279775894,
    -278367434,
    -276956349,
    -275542652,
    -274126357,
    -272707476,
    -271286023,
    -269862012,
    -268435456,
    -267006368,
    -265574762,
    -264140651,
    -262704050,
    -261264971,
    -259823428,
    -258379435,
    -256933005,
    -255484152,
    -254032889,
    -252579231,
    -251123191,
    -249664782,
    -248204019,
    -246740916,
    -245275485,
    -243807741,
    -242337698,
    -240865369,
    -239390769,
    -237913911,
    -236434809,
    -234953478,
    -233469931,
    -231984182,
    -230496245,
    -229006135,
    -227513864,
    -226019449,
    -224522901,
    -223024236,
    -221523468,
    -220020611,
    -218515679,
    -217008686,
    -215499646,
    -213988574,
    -212475484,
    -210960391,
    -209443307,
    -207924249,
    -206403229,
    -204880263,
    -203355365,
    -201828549,
    -200299830,
    -198769222,
    -197236739,
    -195702396,
    -194166207,
    -192628187,
    -191088351,
    -189546713,
    -188003286,
    -186458087,
    -184911130,
    -183362428,
    -181811998,
    -180259852,
    -178706007,
    -177150477,
    -175593275,
    -174034418,
    -172473919,
    -170911794,
    -169348057,
    -167782723,
    -166215807,
    -164647323,
    -163077286,
    -161505712,
    -159932614,
    -158358008,
    -156781909,
    -155204330,
    -153625289,
    -152044798,
    -150462874,
    -148879530,
    -147294783,
    -145708646,
    -144121135,
    -142532265,
    -140942051,
    -139350508,
    -137757651,
    -136163494,
    -134568053,
    -132971343,
    -131373379,
    -129774176,
    -128173750,
    -126572114,
    -124969285,
    -123365277,
    -121760106,
    -120153787,
    -118546334,
    -116937763,
    -115328090,
    -113717329,
    -112105495,
    -110492605,
    -108878672,
    -107263712,
    -105647741,
    -104030774,
    -102412825,
    -100793911,
    -99174046,
    -97553245,
    -95931525,
    -94308900,
    -92685386,
    -91060997,
    -89435750,
    -87809659,
    -86182740,
    -84555009,
    -82926480,
    -81297169,
    -79667091,
    -78036262,
    -76404697,
    -74772411,
    -73139420,
    -71505740,
    -69871385,
    -68236371,
    -66600713,
    -64964428,
    -63327530,
    -61690034,
    -60051957,
    -58413314,
    -56774119,
    -55134390,
    -53494140,
    -51853386,
    -50212142,
    -48570426,
    -46928251,
    -45285633,
    -43642589,
    -41999133,
    -40355280,
    -38711048,
    -37066450,
    -35421502,
    -33776221,
    -32130621,
    -30484718,
    -28838527,
    -27192065,
    -25545346,
    -23898386,
    -22251201,
    -20603806,
    -18956217,
    -17308448,
    -15660517,
    -14012438,
    -12364227,
    -10715899,
    -9067470,
    -7418956,
    -5770371,
    -4121733,
    -2473055,
    -824354,
    824354,
    2473055,
    4121733,
    5770371,
    7418956,
    9067470,
    10715899,
    12364227,
    14012438,
    15660517,
    17308448,
    18956217,
    20603806,
    22251201,
    23898386,
    25545346,
    27192065,
    28838527,
    30484718,
    32130621,
    33776221,
    35421502,
    37066450,
    38711048,
    40355280,
    41999133,
    43642589,
    45285633,
    46928251,
    48570426,
    50212142,
    51853386,
    53494140,
    55134390,
    56774119,
    58413314,
    60051957,
    61690034,
    63327530,
    64964428,
    66600713,
    68236371,
    69871385,
    71505740,
    73139420,
    74772411,
    76404697,
    78036262,
    79667091,
    81297169,
    82926480,
    84555009,
    86182740,
    87809659,
    89435750,
    91060997,
    92685386,
    94308900,
    95931525,
    97553245,
    99174046,
    100793911,
    102412825,
    104030774,
    105647741,
    107263712,
    108878672,
    110492605,
    112105495,
    113717329,
    115328090,
    116937763,
    118546334,
    120153787,
    121760106,
    123365277,
    124969285,
    126572114,
    128173750,
    129774176,
    131373379,
    132971343,
    134568053,
    136163494,
    137757651,
    139350508,
    140942051,
    142532265,
    144121135,
    145708646,
    147294783,
    148879530,
    150462874,
    152044798,
    153625289,
    155204330,
    156781909,
    158358008,
    159932614,
    161505712,
    163077286,
    164647323,
    166215807,
    167782723,
    169348057,
    170911794,
    172473919,
    174034418,
    175593275,
    177150477,
    178706007,
    180259852,
    181811998,
    183362428,
    184911130,
    186458087,
    188003286,
    189546713,
    191088351,
    192628187,
    194166207,
    195702396,
    197236739,
    198769222,
    200299830,
    201828549,
    203355365,
    204880263,
    206403229,
    207924249,
    209443307,
    210960391,
    212475484,
    213988574,
    215499646,
    217008686,
    218515679,
    220020611,
    221523468,
    223024236,
    224522901,
    226019449,
    227513864,
    229006135,
    230496245,
    231984182,
    233469931,
    234953478,
    236434809,
    237913911,
    239390769,
    240865369,
    242337698,
    243807741,
    245275485,
    246740916,
    248204019,
    249664782,
    251123191,
    252579231,
    254032889,
    255484152,
    256933005,
    258379435,
    259823428,
    261264971,
    262704050,
    264140651,
    265574762,
    267006368,
    268435455,
    269862012,
    271286023,
    272707476,
    274126357,
    275542652,
    276956349,
    278367434,
    279775894,
    281181716,
    282584885,
    283985390,
    285383217,
    286778352,
    288170782,
    289560495,
    290947477,
    292331715,
    293713197,
    295091908,
    296467836,
    297840969,
    299211292,
    300578794,
    301943461,
    303305281,
    304664240,
    306020326,
    307373526,
    308723827,
    310071216,
    311415682,
    312757210,
    314095789,
    315431406,
    316764048,
    318093702,
    319420357,
    320743999,
    322064617,
    323382197,
    324696728,
    326008196,
    327316590,
    328621897,
    329924104,
    331223201,
    332519173,
    333812010,
    335101699,
    336388227,
    337671583,
    338951754,
    340228729,
    341502495,
    342773041,
    344040354,
    345304422,
    346565234,
    347822777,
    349077041,
    350328012,
    351575679,
    352820031,
    354061055,
    355298740,
    356533075,
    357764047,
    358991645,
    360215857,
    361436673,
    362654079,
    363868066,
    365078621,
    366285733,
    367489391,
    368689583,
    369886298,
    371079524,
    372269251,
    373455468,
    374638162,
    375817323,
    376992940,
    378165002,
    379333497,
    380498414,
    381659744,
    382817474,
    383971594,
    385122092,
    386268959,
    387412182,
    388551753,
    389687658,
    390819889,
    391948434,
    393073283,
    394194424,
    395311848,
    396425544,
    397535502,
    398641710,
    399744159,
    400842837,
    401937736,
    403028844,
    404116151,
    405199647,
    406279322,
    407355165,
    408427166,
    409495316,
    410559604,
    411620019,
    412676553,
    413729195,
    414777936,
    415822764,
    416863671,
    417900647,
    418933682,
    419962765,
    420987888,
    422009041,
    423026214,
    424039398,
    425048582,
    426053758,
    427054916,
    428052047,
    429045140,
    430034188,
    431019179,
    432000106,
    432976959,
    433949729,
    434918406,
    435882981,
    436843446,
    437799791,
    438752007,
    439700085,
    440644017,
    441583793,
    442519404,
    443450842,
    444378098,
    445301164,
    446220029,
    447134687,
    448045128,
    448951343,
    449853324,
    450751063,
    451644551,
    452533779,
    453418740,
    454299425,
    455175825,
    456047933,
    456915739,
    457779237,
    458638417,
    459493272,
    460343794,
    461189974,
    462031805,
    462869279,
    463702387,
    464531123,
    465355477,
    466175443,
    466991012,
    467802177,
    468608931,
    469411265,
    470209172,
    471002645,
    471791675,
    472576257,
    473356382,
    474132042,
    474903231,
    475669942,
    476432166,
    477189897,
    477943128,
    478691852,
    479436061,
    480175749,
    480910908,
    481641532,
    482367614,
    483089147,
    483806123,
    484518537,
    485226382,
    485929650,
    486628336,
    487322433,
    488011934,
    488696832,
    489377121,
    490052796,
    490723849,
    491390273,
    492052064,
    492709214,
    493361718,
    494009569,
    494652761,
    495291288,
    495925143,
    496554322,
    497178818,
    497798626,
    498413738,
    499024151,
    499629857,
    500230851,
    500827127,
    501418681,
    502005505,
    502587595,
    503164946,
    503737551,
    504305406,
    504868504,
    505426841,
    505980412,
    506529211,
    507073233,
    507612473,
    508146925,
    508676586,
    509201449,
    509721510,
    510236764,
    510747206,
    511252831,
    511753635,
    512249612,
    512740759,
    513227070,
    513708541,
    514185167,
    514656944,
    515123867,
    515585933,
    516043136,
    516495472,
    516942937,
    517385527,
    517823238,
    518256066,
    518684005,
    519107053,
    519525206,
    519938459,
    520346809,
    520750251,
    521148782,
    521542399,
    521931096,
    522314872,
    522693722,
    523067642,
    523436629,
    523800680,
    524159792,
    524513959,
    524863181,
    525207452,
    525546770,
    525881132,
    526210535,
    526534975,
    526854449,
    527168955,
    527478489,
    527783048,
    528082630,
    528377232,
    528666851,
    528951484,
    529231129,
    529505782,
    529775442,
    530040106,
    530299771,
    530554435,
    530804095,
    531048749,
    531288395,
    531523031,
    531752654,
    531977262,
    532196854,
    532411426,
    532620977,
    532825505,
    533025008,
    533219484,
    533408932,
    533593349,
    533772734,
    533947085,
    534116400,
    534280679,
    534439918,
    534594118,
    534743276,
    534887390,
    535026461,
    535160485,
    535289463,
    535413392,
    535532273,
    535646102,
    535754880,
    535858605,
    535957277,
    536050895,
    536139457,
    536222962,
    536301411,
    536374802,
    536443135,
    536506408,
    536564622,
    536617775,
    536665868,
    536708900,
    536746870,
    536779778,
    536807624,
    536830407,
    536848128,
    536860785,
    536868380,
    536870912
])

x_table = np.array([
    -843314856,
    -841666147,
    -840017437,
    -838368728,
    -836720018,
    -835071309,
    -833422600,
    -831773890,
    -830125181,
    -828476471,
    -826827762,
    -825179053,
    -823530343,
    -821881634,
    -820232924,
    -818584215,
    -816935506,
    -815286796,
    -813638087,
    -811989377,
    -810340668,
    -808691959,
    -807043249,
    -805394540,
    -803745831,
    -802097121,
    -800448412,
    -798799702,
    -797150993,
    -795502284,
    -793853574,
    -792204865,
    -790556155,
    -788907446,
    -787258737,
    -785610027,
    -783961318,
    -782312608,
    -780663899,
    -779015190,
    -777366480,
    -775717771,
    -774069061,
    -772420352,
    -770771643,
    -769122933,
    -767474224,
    -765825514,
    -764176805,
    -762528096,
    -760879386,
    -759230677,
    -757581967,
    -755933258,
    -754284549,
    -752635839,
    -750987130,
    -749338420,
    -747689711,
    -746041002,
    -744392292,
    -742743583,
    -741094873,
    -739446164,
    -737797455,
    -736148745,
    -734500036,
    -732851326,
    -731202617,
    -729553908,
    -727905198,
    -726256489,
    -724607779,
    -722959070,
    -721310361,
    -719661651,
    -718012942,
    -716364232,
    -714715523,
    -713066814,
    -711418104,
    -709769395,
    -708120685,
    -706471976,
    -704823267,
    -703174557,
    -701525848,
    -699877138,
    -698228429,
    -696579720,
    -694931010,
    -693282301,
    -691633592,
    -689984882,
    -688336173,
    -686687463,
    -685038754,
    -683390045,
    -681741335,
    -680092626,
    -678443916,
    -676795207,
    -675146498,
    -673497788,
    -671849079,
    -670200369,
    -668551660,
    -666902951,
    -665254241,
    -663605532,
    -661956822,
    -660308113,
    -658659404,
    -657010694,
    -655361985,
    -653713275,
    -652064566,
    -650415857,
    -648767147,
    -647118438,
    -645469728,
    -643821019,
    -642172310,
    -640523600,
    -638874891,
    -637226181,
    -635577472,
    -633928763,
    -632280053,
    -630631344,
    -628982634,
    -627333925,
    -625685216,
    -624036506,
    -622387797,
    -620739087,
    -619090378,
    -617441669,
    -615792959,
    -614144250,
    -612495540,
    -610846831,
    -609198122,
    -607549412,
    -605900703,
    -604251993,
    -602603284,
    -600954575,
    -599305865,
    -597657156,
    -596008446,
    -594359737,
    -592711028,
    -591062318,
    -589413609,
    -587764900,
    -586116190,
    -584467481,
    -582818771,
    -581170062,
    -579521353,
    -577872643,
    -576223934,
    -574575224,
    -572926515,
    -571277806,
    -569629096,
    -567980387,
    -566331677,
    -564682968,
    -563034259,
    -561385549,
    -559736840,
    -558088130,
    -556439421,
    -554790712,
    -553142002,
    -551493293,
    -549844583,
    -548195874,
    -546547165,
    -544898455,
    -543249746,
    -541601036,
    -539952327,
    -538303618,
    -536654908,
    -535006199,
    -533357489,
    -531708780,
    -530060071,
    -528411361,
    -526762652,
    -525113942,
    -523465233,
    -521816524,
    -520167814,
    -518519105,
    -516870395,
    -515221686,
    -513572977,
    -511924267,
    -510275558,
    -508626848,
    -506978139,
    -505329430,
    -503680720,
    -502032011,
    -500383301,
    -498734592,
    -497085883,
    -495437173,
    -493788464,
    -492139754,
    -490491045,
    -488842336,
    -487193626,
    -485544917,
    -483896208,
    -482247498,
    -480598789,
    -478950079,
    -477301370,
    -475652661,
    -474003951,
    -472355242,
    -470706532,
    -469057823,
    -467409114,
    -465760404,
    -464111695,
    -462462985,
    -460814276,
    -459165567,
    -457516857,
    -455868148,
    -454219438,
    -452570729,
    -450922020,
    -449273310,
    -447624601,
    -445975891,
    -444327182,
    -442678473,
    -441029763,
    -439381054,
    -437732344,
    -436083635,
    -434434926,
    -432786216,
    -431137507,
    -429488797,
    -427840088,
    -426191379,
    -424542669,
    -422893960,
    -421245250,
    -419596541,
    -417947832,
    -416299122,
    -414650413,
    -413001703,
    -411352994,
    -409704285,
    -408055575,
    -406406866,
    -404758156,
    -403109447,
    -401460738,
    -399812028,
    -398163319,
    -396514609,
    -394865900,
    -393217191,
    -391568481,
    -389919772,
    -388271062,
    -386622353,
    -384973644,
    -383324934,
    -381676225,
    -380027515,
    -378378806,
    -376730097,
    -375081387,
    -373432678,
    -371783969,
    -370135259,
    -368486550,
    -366837840,
    -365189131,
    -363540422,
    -361891712,
    -360243003,
    -358594293,
    -356945584,
    -355296875,
    -353648165,
    -351999456,
    -350350746,
    -348702037,
    -347053328,
    -345404618,
    -343755909,
    -342107199,
    -340458490,
    -338809781,
    -337161071,
    -335512362,
    -333863652,
    -332214943,
    -330566234,
    -328917524,
    -327268815,
    -325620105,
    -323971396,
    -322322687,
    -320673977,
    -319025268,
    -317376558,
    -315727849,
    -314079140,
    -312430430,
    -310781721,
    -309133011,
    -307484302,
    -305835593,
    -304186883,
    -302538174,
    -300889464,
    -299240755,
    -297592046,
    -295943336,
    -294294627,
    -292645917,
    -290997208,
    -289348499,
    -287699789,
    -286051080,
    -284402370,
    -282753661,
    -281104952,
    -279456242,
    -277807533,
    -276158823,
    -274510114,
    -272861405,
    -271212695,
    -269563986,
    -267915277,
    -266266567,
    -264617858,
    -262969148,
    -261320439,
    -259671730,
    -258023020,
    -256374311,
    -254725601,
    -253076892,
    -251428183,
    -249779473,
    -248130764,
    -246482054,
    -244833345,
    -243184636,
    -241535926,
    -239887217,
    -238238507,
    -236589798,
    -234941089,
    -233292379,
    -231643670,
    -229994960,
    -228346251,
    -226697542,
    -225048832,
    -223400123,
    -221751413,
    -220102704,
    -218453995,
    -216805285,
    -215156576,
    -213507866,
    -211859157,
    -210210448,
    -208561738,
    -206913029,
    -205264319,
    -203615610,
    -201966901,
    -200318191,
    -198669482,
    -197020772,
    -195372063,
    -193723354,
    -192074644,
    -190425935,
    -188777225,
    -187128516,
    -185479807,
    -183831097,
    -182182388,
    -180533678,
    -178884969,
    -177236260,
    -175587550,
    -173938841,
    -172290131,
    -170641422,
    -168992713,
    -167344003,
    -165695294,
    -164046584,
    -162397875,
    -160749166,
    -159100456,
    -157451747,
    -155803038,
    -154154328,
    -152505619,
    -150856909,
    -149208200,
    -147559491,
    -145910781,
    -144262072,
    -142613362,
    -140964653,
    -139315944,
    -137667234,
    -136018525,
    -134369815,
    -132721106,
    -131072397,
    -129423687,
    -127774978,
    -126126268,
    -124477559,
    -122828850,
    -121180140,
    -119531431,
    -117882721,
    -116234012,
    -114585303,
    -112936593,
    -111287884,
    -109639174,
    -107990465,
    -106341756,
    -104693046,
    -103044337,
    -101395627,
    -99746918,
    -98098209,
    -96449499,
    -94800790,
    -93152080,
    -91503371,
    -89854662,
    -88205952,
    -86557243,
    -84908533,
    -83259824,
    -81611115,
    -79962405,
    -78313696,
    -76664986,
    -75016277,
    -73367568,
    -71718858,
    -70070149,
    -68421439,
    -66772730,
    -65124021,
    -63475311,
    -61826602,
    -60177892,
    -58529183,
    -56880474,
    -55231764,
    -53583055,
    -51934346,
    -50285636,
    -48636927,
    -46988217,
    -45339508,
    -43690799,
    -42042089,
    -40393380,
    -38744670,
    -37095961,
    -35447252,
    -33798542,
    -32149833,
    -30501123,
    -28852414,
    -27203705,
    -25554995,
    -23906286,
    -22257576,
    -20608867,
    -18960158,
    -17311448,
    -15662739,
    -14014029,
    -12365320,
    -10716611,
    -9067901,
    -7419192,
    -5770482,
    -4121773,
    -2473064,
    -824354,
    824354,
    2473064,
    4121773,
    5770482,
    7419192,
    9067901,
    10716611,
    12365320,
    14014029,
    15662739,
    17311448,
    18960158,
    20608867,
    22257576,
    23906286,
    25554995,
    27203705,
    28852414,
    30501123,
    32149833,
    33798542,
    35447252,
    37095961,
    38744670,
    40393380,
    42042089,
    43690799,
    45339508,
    46988217,
    48636927,
    50285636,
    51934346,
    53583055,
    55231764,
    56880474,
    58529183,
    60177892,
    61826602,
    63475311,
    65124021,
    66772730,
    68421439,
    70070149,
    71718858,
    73367568,
    75016277,
    76664986,
    78313696,
    79962405,
    81611115,
    83259824,
    84908533,
    86557243,
    88205952,
    89854662,
    91503371,
    93152080,
    94800790,
    96449499,
    98098209,
    99746918,
    101395627,
    103044337,
    104693046,
    106341756,
    107990465,
    109639174,
    111287884,
    112936593,
    114585303,
    116234012,
    117882721,
    119531431,
    121180140,
    122828850,
    124477559,
    126126268,
    127774978,
    129423687,
    131072397,
    132721106,
    134369815,
    136018525,
    137667234,
    139315944,
    140964653,
    142613362,
    144262072,
    145910781,
    147559491,
    149208200,
    150856909,
    152505619,
    154154328,
    155803038,
    157451747,
    159100456,
    160749166,
    162397875,
    164046584,
    165695294,
    167344003,
    168992713,
    170641422,
    172290131,
    173938841,
    175587550,
    177236260,
    178884969,
    180533678,
    182182388,
    183831097,
    185479807,
    187128516,
    188777225,
    190425935,
    192074644,
    193723354,
    195372063,
    197020772,
    198669482,
    200318191,
    201966901,
    203615610,
    205264319,
    206913029,
    208561738,
    210210448,
    211859157,
    213507866,
    215156576,
    216805285,
    218453995,
    220102704,
    221751413,
    223400123,
    225048832,
    226697542,
    228346251,
    229994960,
    231643670,
    233292379,
    234941089,
    236589798,
    238238507,
    239887217,
    241535926,
    243184636,
    244833345,
    246482054,
    248130764,
    249779473,
    251428183,
    253076892,
    254725601,
    256374311,
    258023020,
    259671730,
    261320439,
    262969148,
    264617858,
    266266567,
    267915277,
    269563986,
    271212695,
    272861405,
    274510114,
    276158823,
    277807533,
    279456242,
    281104952,
    282753661,
    284402370,
    286051080,
    287699789,
    289348499,
    290997208,
    292645917,
    294294627,
    295943336,
    297592046,
    299240755,
    300889464,
    302538174,
    304186883,
    305835593,
    307484302,
    309133011,
    310781721,
    312430430,
    314079140,
    315727849,
    317376558,
    319025268,
    320673977,
    322322687,
    323971396,
    325620105,
    327268815,
    328917524,
    330566234,
    332214943,
    333863652,
    335512362,
    337161071,
    338809781,
    340458490,
    342107199,
    343755909,
    345404618,
    347053328,
    348702037,
    350350746,
    351999456,
    353648165,
    355296875,
    356945584,
    358594293,
    360243003,
    361891712,
    363540422,
    365189131,
    366837840,
    368486550,
    370135259,
    371783969,
    373432678,
    375081387,
    376730097,
    378378806,
    380027515,
    381676225,
    383324934,
    384973644,
    386622353,
    388271062,
    389919772,
    391568481,
    393217191,
    394865900,
    396514609,
    398163319,
    399812028,
    401460738,
    403109447,
    404758156,
    406406866,
    408055575,
    409704285,
    411352994,
    413001703,
    414650413,
    416299122,
    417947832,
    419596541,
    421245250,
    422893960,
    424542669,
    426191379,
    427840088,
    429488797,
    431137507,
    432786216,
    434434926,
    436083635,
    437732344,
    439381054,
    441029763,
    442678473,
    444327182,
    445975891,
    447624601,
    449273310,
    450922020,
    452570729,
    454219438,
    455868148,
    457516857,
    459165567,
    460814276,
    462462985,
    464111695,
    465760404,
    467409114,
    469057823,
    470706532,
    472355242,
    474003951,
    475652661,
    477301370,
    478950079,
    480598789,
    482247498,
    483896208,
    485544917,
    487193626,
    488842336,
    490491045,
    492139754,
    493788464,
    495437173,
    497085883,
    498734592,
    500383301,
    502032011,
    503680720,
    505329430,
    506978139,
    508626848,
    510275558,
    511924267,
    513572977,
    515221686,
    516870395,
    518519105,
    520167814,
    521816524,
    523465233,
    525113942,
    526762652,
    528411361,
    530060071,
    531708780,
    533357489,
    535006199,
    536654908,
    538303618,
    539952327,
    541601036,
    543249746,
    544898455,
    546547165,
    548195874,
    549844583,
    551493293,
    553142002,
    554790712,
    556439421,
    558088130,
    559736840,
    561385549,
    563034259,
    564682968,
    566331677,
    567980387,
    569629096,
    571277806,
    572926515,
    574575224,
    576223934,
    577872643,
    579521353,
    581170062,
    582818771,
    584467481,
    586116190,
    587764900,
    589413609,
    591062318,
    592711028,
    594359737,
    596008446,
    597657156,
    599305865,
    600954575,
    602603284,
    604251993,
    605900703,
    607549412,
    609198122,
    610846831,
    612495540,
    614144250,
    615792959,
    617441669,
    619090378,
    620739087,
    622387797,
    624036506,
    625685216,
    627333925,
    628982634,
    630631344,
    632280053,
    633928763,
    635577472,
    637226181,
    638874891,
    640523600,
    642172310,
    643821019,
    645469728,
    647118438,
    648767147,
    650415857,
    652064566,
    653713275,
    655361985,
    657010694,
    658659404,
    660308113,
    661956822,
    663605532,
    665254241,
    666902951,
    668551660,
    670200369,
    671849079,
    673497788,
    675146498,
    676795207,
    678443916,
    680092626,
    681741335,
    683390045,
    685038754,
    686687463,
    688336173,
    689984882,
    691633592,
    693282301,
    694931010,
    696579720,
    698228429,
    699877138,
    701525848,
    703174557,
    704823267,
    706471976,
    708120685,
    709769395,
    711418104,
    713066814,
    714715523,
    716364232,
    718012942,
    719661651,
    721310361,
    722959070,
    724607779,
    726256489,
    727905198,
    729553908,
    731202617,
    732851326,
    734500036,
    736148745,
    737797455,
    739446164,
    741094873,
    742743583,
    744392292,
    746041002,
    747689711,
    749338420,
    750987130,
    752635839,
    754284549,
    755933258,
    757581967,
    759230677,
    760879386,
    762528096,
    764176805,
    765825514,
    767474224,
    769122933,
    770771643,
    772420352,
    774069061,
    775717771,
    777366480,
    779015190,
    780663899,
    782312608,
    783961318,
    785610027,
    787258737,
    788907446,
    790556155,
    792204865,
    793853574,
    795502284,
    797150993,
    798799702,
    800448412,
    802097121,
    803745831,
    805394540,
    807043249,
    808691959,
    810340668,
    811989377,
    813638087,
    815286796,
    816935506,
    818584215,
    820232924,
    821881634,
    823530343,
    825179053,
    826827762,
    828476471,
    830125181,
    831773890,
    833422600,
    835071309,
    836720018,
    838368728,
    840017437,
    841666147,
    843314856
])

def chebyshev_sin_np(x: np.ndarray, N: int = 29) -> np.ndarray:

    coeffs = np.array([
        -54396394,
         3554557,
        -93149,
         1354,
        -12,
    ], dtype=np.int64)

    # Constants
    pi_major = 1686629738
    pi_minor = -46

    x = x.astype(np.int64)  # Ensure input is int64 for safe computations

    # Polynomial computation
    x2 = np.right_shift(x * x, N)
    p9 = coeffs[4]
    p7 = np.right_shift(p9 * x2, N) + coeffs[3]
    p5 = np.right_shift(p7 * x2, N) + coeffs[2]
    p3 = np.right_shift(p5 * x2, N) + coeffs[1]
    p1 = np.right_shift(p3 * x2, N) + coeffs[0]

    # Trigonometric term computation
    t1 = np.right_shift((x - pi_major - pi_minor) * (x + pi_major + pi_minor), N)
    t2 = np.right_shift(t1 * p1, N)

    return np.right_shift(t2 * x, N).astype(np.int32)  # Final result as int32



def linear_interpolate(x0, y0, x1, y1, x):
    return y0 + (y1 - y0) * (x - x0) / (x1 - x0)

def lookup_sin(x):
    spacing = 1648709
    i = (x + 843314857) // spacing
    return linear_interpolate(x_table[i], sin_table[i], x_table[i + 1], sin_table[i + 1], x)



def create_dot_plot(x_values, y_values, xlabel = "X Values", ylabel = "Y Values", title = "Dot Plot", filename = "filename.png"):

    if len(x_values) != len(y_values):
        raise ValueError("x_values and y_values must have the same length.")

    # Sort x_values and get the indices
    sort_indices = np.argsort(x_values)

    # Reorder y_values according to the sorted indices of x_values
    x_sorted = x_values[sort_indices]
    y_sorted = y_values[sort_indices]

    plt.figure(figsize=(8, 6))
    # plt.scatter(x_values, y_values, marker='o', s=10)
    plt.plot(x_sorted, y_sorted, linestyle='-')

    plt.xlabel(xlabel)
    plt.ylabel(ylabel)
    plt.title(title)
    plt.grid(False)

    textstr = f"Average error: {np.mean(y_values):.12f}\nSample count: {len(y_values):,}"
    props = dict(boxstyle='round', facecolor='wheat', alpha=0.5)
    plt.text(0.20, 0.95, textstr, transform=plt.gca().transAxes, fontsize=10,
             verticalalignment='top', bbox=props)
    
    xticks = np.array([-np.pi/2, -np.pi/4, 0, np.pi/4, np.pi/2])
    xticklabels = [r"$-\frac{\pi}{2}$", r"$-\frac{\pi}{4}$", "0", r"$\frac{\pi}{4}$", r"$\frac{\pi}{2}$"]
    plt.xticks(xticks, xticklabels)

    plt.savefig(filename)
    plt.close()


# Example usage
if __name__ == "__main__":

    PI_HALF = math.pi / 2
    TWO_POW_29 = 2 ** 29

    # max value 1000000000

    random_floats = np.random.uniform(-PI_HALF, PI_HALF, 1000)
    input_values = (random_floats * TWO_POW_29).astype(np.int32)
    results = chebyshev_sin_np(input_values)
    results_floats = results / TWO_POW_29
    diff = np.abs(results_floats - np.sin(random_floats))
    create_dot_plot(x_values = random_floats, y_values = diff, xlabel = "Input value (x)", ylabel = "Difference between result and actual", title = "Chybyshev Error", filename = "fig/chebyshev.png")

    random_floats = np.random.uniform(-PI_HALF, PI_HALF, 1000000000)
    input_values = (random_floats * TWO_POW_29).astype(np.int32)
    results = chebyshev_sin_np(input_values)
    results_floats = results / TWO_POW_29
    diff = np.abs(results_floats - np.sin(random_floats))
    print(np.mean(diff))
    
    random_floats = np.random.uniform(-PI_HALF, PI_HALF, 1000)
    input_values = (random_floats * TWO_POW_29).astype(np.int32)
    results = lookup_sin(input_values)
    results_floats = results / TWO_POW_29
    diff = np.abs(results_floats - np.sin(random_floats))
    create_dot_plot(x_values = random_floats, y_values = diff, xlabel = "Input value (x)", ylabel = "Difference between result and actual", title = "Lookup Error", filename = "fig/lookup.png")
    
    random_floats = np.random.uniform(-PI_HALF, PI_HALF-.003, 1000000000)
    input_values = (random_floats * TWO_POW_29).astype(np.int32)
    results = lookup_sin(input_values)
    results_floats = results / TWO_POW_29
    diff = np.abs(results_floats - np.sin(random_floats))
    print(np.mean(diff))
